# CS - Operating System

## 프로그램: 어떤 작업을 위해 실행할 수 있는 파일

## 프로세스

- 프로그램을 메모리 상에서 실행중인 작업
- 메모리에 올라와 실행되고 있는 프로그램의 인스턴스 (독립적 개체)
- 운영체제로 부터 시스템 자원을 할당받는 작업 단위, 동적인 개념으로 실행된 프로그램을 의미
- 할당된 자원의 예시( cpu시간, 운영되기 위해 필요한 주소 공간)

- 특징

- 프로세스는 독립된 메모리 영역을 할당받는다.
- 기본적으로 프로세스당 최소 1개의 스레드를 가지고 있다.
- 각 프로세스는 별도의 주소 공간에서 실행되며, 한 프로세스는 다른 프로세스의 변수나 자료구조에 접근할 수 없다.

## 스레드

프로세스 안에서 실행되는 여러 흐름 단위

프로세스의 특정한 수행 경로

프로세스가 할당받은 자원을 이용하는 실행의 단위

- 특징

- 스레드는 프로세스 내에서 스택만 따로 할당 받고 코드,데이터, 힙 영역은 공유한다.
- 한 프로세스 내에서 동작되는 여러 실행 흐름으로 프로세스 내의 주소 공간이나 자원들을 은 프로세스 내에 스레드끼리 공유하면서 실행한다.
- 각 스레드는 별도의 레지스터와 스택을 갖고 있지만, 힙 메모리는 서로 읽고 쓸 수 있다.
- 한 스레드가 프로세스 자원을 변경하면 다른 이웃 스레드도 변경 결과를 즉시 볼 수 있다.

## 멀티 프로세스

하나의 응용 프로그램을 여러 개의 프로세스로 구성하여 각 프로세스가 하나의 작업을 처리하도록 하는 것이다.

- 장점
  - 여러 개의 자식 프로세스 중 하나에 문제가 발생하면 해당 자식 프로세스만 죽고 다른 영향이 확산되지 않는다.
- 단점
  - Context switching에서의 오버해드

( cpu에서 여러 프로세스를 돌아가면서 작업을 처리하는데 이 과정을 Context switching이라고 한다.

구체적으로 동작 중인 프로세스가 대기를 하면서 해당 프로세스의 상태를 보gh하고 대기하고 있던 다음 순서의 프로세스가 동작하면서 이전에 보관했던 프로세스의 상태를 복하는 작업을 말한다.)

- Context switching 과정에서 캐쉬 메모리 초기화 등 무거운 작업이 진행되고 많은 시간이 소모되는 등의 오버헤드가 발생하게 된다.
- 프로세스는 각가의 독립된 메모리 영역을 할당받았기 때문에 프로세스 사이에서 공유하는 메모리가 없어 Context switching이 발생하면 캐쉬에 있는 모든 데이터를 모두 리셋하고 다시 캐쉬 정보를 불러와야 한다.
- 프로세스 사이에 어렵고 복잡한 통신기법(IPC)
- 프로세스는 각가의 독립된 메모리 영역을 할당받았기 때문에 하나의 프로그램에 속하는 프로세스들 사이에 변수를 공유할 수 없다.

### Context Switching

Cpu는 한번에 하나의 프로세스만 실행 가능하다.

Cpu에서 여러 프로세스를 돌아가면서 작업처리하는데 이 과정을 context switching이라고 한다.

구체적으로 동작 중인 프로세스가 대기를 하면서 해당 프로세스의 상태를 보관하고, 대기하고 있던 다음 순서의 프로세스가 동작하면서 이전에 보관했던 프로세스의 상태를 복구하는 작업을 말한다.

## 멀티스레드

하나의 응용프로그램을 여러 개의 스레드로 구성하고 각 스레드로 하여금 하나의 작업을 처리하도록 하는 것 이다.

윈도우, 리눅스 등 많은 운영체제들이 멀티 프로세싱을 지원하고 있지만 멀티 스레딩을 기본으로 하고 있다.

웹 서버가 대표적인 멀티스레드 방식이다.

- 장점
  - 시스템 자원소모 감소
    - 프로세스를 생성하여 자원 할당하는 시스템 콜이 줄어 자원을 효율적으로 관리 할 수 있다.
  - 시스템 처리율 향상(처리비용 감소)
    - 스레드 간 데이터를 주고 받는 것이 간단해지고 시스템 자원 소모가 줄어든다.
    - 스레드 사이 작업량이 작아 context switching이 빠르다( 캐시메모리를 비율 필요가 없다.
  - 간단한 통신방법으로 프로그램 응답시간 단축
    - 프로세스 내 스택영역을 제외한 메모리 영역을 공유하기 때문에 통신 비용이 적다.
    - 힙 영역을 공유하므로 데이터를 주고 받을 수 있다.
- 단점
  - 자원을 공유하기에 동기화 문제가 발생(병목현상, 데드락)
  - 주의 깊은 설계가 필요하고 디버깅이 어려움 ( 불필요한 부분까지 동기화하게 되면 대기시간으로 인해 성능저하 발생)
  - 하나의 스레드에 문제가 생기면 전체 프로세스가 영향을 받는다.
  - 단일 프로세스 시스템의 경우 효과를 기대하기 어렵다.
  ## _프로세스를 스케줄링하기 위한 Queue 에는 세 가지 종류가 존재한다._
  1. Job Queue : 현재 시스템 내에 있는 모든 프로세스의 집합
  2. Ready Queue : 현재 메모리 내에 있으면서 CPU 를 잡아서 실행되기를 기다리는 프로세스의 집합
  3. Device Queue : Device I/O 작업을 대기하고 있는 프로세스의 집합
  ### 장기스케쥴러
  메모리는 한정되어 있는데 많은 프로세스들이 한꺼번에 메모리에 올라올 경우, 대용량 메모리
  (일반적으로 디스크)에 임시로 저장된다. 이 pool에 저장되어 있는 프로세스 중 어떤 프로세스에 메모리를 할당하여 ready queue로 보낼지 결정하는 역할을 한다.
  - 메모리와 디스크 사이의 스케줄링 담당
  - 프로세스에 메모리 및 각종 리소스를 할당
  - Degree of Multiprogramming 제어
  (메모리에 여러 프로그램이 올라가는것) 몇 개의 프로그램이 올라갈 것인지를 제어
  - 프로세스의 상태 ( 메모리 내에서 new -> ready )
  ### 단기 스케줄러
  - Cpu와 메모리 사이의 스케줄링을 담당
  - Ready Queue에 존재하는 프로세스 중 어떤 프로세스를 run 시킬지 결정
  - 프로세스에 cpu를 할당
  - 프로세스의 상태
  ( ready -> running -> waiting -> ready)
  ### 중기 스케줄러
  - 여유 공간 마련을 위해 프로세스를 통째로 메모리에서 디스크로 쫓아냄 (swapping)
  - 프로세스에게서 메모리를 deallocte(할당해제)
  - Degree of multiprogramming 제어
  - 현 시스템에서 메모리에 너무 많은 프로그램이 동시에 올라가는 것을 조절하는 스케줄러
  - 프로세스의 상태
  ( ready -> suspended)
