## DB 기본 용어

#### 릴레이션(=Table)

- 서로 연관된 [튜플(=레코드)]()들의 집합
- 행과 열로 이루어진 데이터의 집합
- 관계형 데이터베이스에서 정보를 구분하여 저장하는 기본 단위
  - 즉, 릴레이션이란 DB 테이블을 의미
- 하나의 릴레이션은 현실세계의 어떤 개체(=entity)를 표현하고 저장하는데 사용
- 특징
  - 각 릴레이션(=튜플)은 오직 하나의 레코드 타입만 포함
  - 한 속성 내의 값들은 모두 같은 유형
  - 릴레이션 내 각 속성들 or 튜플들의 순서는 중요하지 않음
  - 동일한 튜플이 두 개 이상 존재 X
    - 각 튜플을 식별할 수 있는 속성들의 부분집합을 키로 설정
  - 각 속성의 이름은 한 릴레이션 내에서만 고유하면 됨
    - 즉, 한 릴레이션 내에서는 중복되는 속성명이 있으면 안된다는 것
- 릴레이션 키
  - 각 튜플을 고유하게 식별할 수 있는 하나 이상의 속성들의 모임



#### 속성(=Attribute, Field)

- 릴레이션에 저장될 개체의 어떤 항목
  - 하나의 열(Column)을 의미
    - 하나의 열은 하나의 속성 정보를 표시
- 같은 릴레이션 내에서 속성명은 고유해야함
- 속성의 수를 차수(=Degree)라고 함
  - 유효한 릴레이션의 최소 차수는 1
    - 즉, 릴레이션은 적어도 하나 이상의 속성을 가져야함



#### 튜플(=Record)

- 릴레이션에서 단일 구조 데이터 항목
  - 릴레이션의 각 행을 의미
  - 관계된 데이터의 묶음
- 같은 릴레이션에서 같은 값을 가진 튜플은 존재 X
- 튜플의 수는 카디날리티(Cardinality)라고 함
  - 차수와 다르게 0을 가질 수 있음
    - = 아직 데이터가 삽입되지 않은 테이블의 경우



#### 도메인(Domain)

- 릴레이션에 포함된 **각각의 속성들이 가질 수 있는 값들의 집합**
  - 릴레이션에 저장되는 데이터 값들이 본래 의도했던 값들만 저장되고 관리하기 위함
- 동일한 도메인이 여러 속성에서 사용될 수 있음



#### 스키마 (Schema)

- 데이터베이스의 구조와 제약 조건에 관한 전반적인 명세를 기술한 메타데이터의 집합
- 데이터 개체, 속성, 관계, 제약 조건 등에 관해 전반적으로 정의
  - 테이블에 필요한 컬럼의 타입과 네이밍, 데이터 레코드의 크기, 키의 정의 등 구체적으로 정의

- 데이터베이스의 골격 구조를 나타내는 일종의 도면
- 즉, 데이터베이스의 구조를 전반적으로 기술한 것
- 사용자의 관점에 따라 외부 스키마, 개념 스키마, 내부 스키마로 나뉨

##### 외부 스키마(=서브스키마, 사용자 뷰)

- 사용자의 입장에서 정의한 스키마
  - 데이터를 어떤 형식, 구조, 화면을 통해 사용자에게 보여줄 것인가?
- 하나의 데이터베이스에는 여러개의 <span style='background-color:yellow; font-weight:bold'>외부 스키마</span>가 있을 수 있음
- 일반 사용자에게는 질의어(SQL)를 이용해 DB를 쉽게 사용할 수 있음
  - 응용 프로그래머는 언어(C,Java)를 사용해서 DB에 접근



##### 개념 스키마(=전체적인 뷰)

- 조직체 전체를 관장하는 입장에서 정의한 스키마
- DB에 대한 모든 논리적 구조를 기술
- 데이터베이스에 하나만 존재
- 객체 간의 관계와 제약조건, 데이터베이스의 접근 구너한, 보안 및 무결성 규칙에 관한 명세
- 통상 스키마라고 하면 개념스키마를 의미



##### 내부 스키마

- 시스템 프로그래머나 시스템 설계자가 보는 관점의 스키마

  - = 물리적 저장장치의 입장에서 본 데이터베이스 구조

- 데이터베이스가 어떻게 저장장치에 저장될 것인지에 대한 명세

  - 실제로 데이터베이스에 저장될 레코드의 물리적인 구조
  - 데이터베이스에 저장될 레코드의 물리적인 구조, 저장데이터 항목의 표현 방법, 내부 레코드의 물리적 순서 등을 나타냄

- 물리적인 저장장치와 데이터베이스 간의 관계를 정의

  

#### Key

> 데이터베이스에서 조건에 만족하는 튜플을 찾거나 정렬할 때, **튜플들을 서로 구분할 수 있는** 기준이 되는 속성을 의미

##### 슈퍼키(Super Key)

- 테이블의 행을 고유하게 식별할 수 있는 속성 또는 속성의 집합
  - 유일성을 만족하는 키
    - 해당 속성 값은 튜플마다 모두 다른 값을 가져야한다 (ex. 주민등록번호)
  - **유일성은 만족하지만 최소성은 만족하지 않음**
- 한 릴레이션 내에 있는 속성들의 집합으로 구성된 키
- 어떤 속성끼리 묶던 중복값이 나오지 않고 서로 구분할 수 있으면 됨



##### 복합키(Composite Key)

- 2개 이상의 속성을 사용한 키



##### 후보키(Candidate Key)

- 릴레이션을 구성하는 속성들 중에서 튜플을 유일하게 식별하기 위해 사용하는 속성들의 부분 집합
  - 즉, 각 튜플을 유일하게 식별할 수 있는 속성의 집합
- 유일성과 최소성을 만족하는 키
  - 최소한의 속성 갯수로 각 튜플을 구분할 수 있어야함
    - = 최소성을 만족한다
  - **여러 슈퍼키 중 속성 갯수가 가장 적은 것**
- 기본키로 사용할 수 있는 속성들
- 모든 릴레이션에는 반드시 하나 이상의 후보키가 존재



##### 기본키(Primary Key)

- 후보키에서 선택된 키
  - 한 릴레이션에서 특정 튜플을 유일하게 구별할 수 있다는 것
  - 또한, 최소성과 유일성을 만족함
- null 값 혹은 중복값을 가질 수 없음



##### 대체키(Alternate Key)

- 후보키 중 기본키로 선택되지 않은 키
- 선택된 기본키가 없어지게 되면 대체할 수 있음



##### 외래키(Foreign Key)

- 서로 다른 테이블 간의 관계를 맺어주는 키
- 다른 테이블의 기본키를 참조하는 속성의 집합
  - 기본키를 참조하지만 외래키가 기본키는 아닐 수 있음
    - 즉, null 값을 가질 수 있고, 서로 다른 튜플이 같은 값을 가질 수 있음
  - 즉, **어떤 릴레이션에 소속된 속성 또는 속성 집합이 다른 릴레이션의 기본키가 되는 키**
- 외래키가 되는 속성과 기본키가 되는 속성의 도메인은 같아야함
- 참조되는 부모 테이블은 먼저 삭제 될 수 없음
  - 부모테이블이 먼저 삭제되면 부모테이블을 참조하고 있던 자식테이블에서 외래키 오류 발생



#### 정규화(Normalization)

##### 정규화란?

- 이상현상이 있는 릴레이션을 분해하여 이상현상을 없애는 과정

  - 이상현상이 존재하는 릴레이션을 분해하면 여러 개의 릴레이션이 생성됨

  - 즉, 이상이 있는 관계를 재구성해서 작고 잘 조작된 관계를 생성하고자 함

- 테이블 간에 중복된 데이터가 최소화되도록 데이터를 구조화 하는 프로세스

  - 무결성을 유지할 수 있음

  - DB의 저장 용량을 줄일 수 있음

##### 정규화의 목적

- 저장공간과 자원을 효율적으로 사용하기 위함
- 삽입/갱신/삭제 시 발생할 수 있는 이상 현상을 방지하기 위함
  - 삽입 이상 : 데이터를 저장할 때, 원하지 않는 정보가 함께 삽입되어 불필요한 데이터가 자원을 낭비하는 경우 (ex. null값)
  - 삭제 이상 : 특정값을 삭제할 때 유지되어야 하는 정보까지 함께 삭제되는 경우
  - 갱신 이상 : 특정값을 갱신 시킬 때, 정보의 모순성이 발생되는 경우

- 관련이 없는 함수 종속성은 별개의 릴레이션으로 표현

##### 정규화의 장점

- 데이터베이스 변경 시 이상현상을 제거할 수 있음
- 정규화된 데이터베이스 구조에서는 새로운 데이터 형의 추가로 인한 확장시, 그 구조를 변경하지 않아도 되거나 일부만 변경해도 됨
- 데이터베이스와 연동된 응용프로그램에 최소한의 영향만을 미치게 되어, 응용 프로그램의 생명을 연장시킴

##### 정규화의 단점

- 릴레이션의 분해로 인해 릴레이션 간 JOIN 연산이 많아짐
- 질의에 대한 응답 시간이 느려질 수 있음
  - 빨라질 수도 있고 느려질 수도 있음



##### 정규화 과정

###### 제 1정규형

- 릴레이션에 속한 모든 속성의 도메인이 더 이상 분해되지 않는 원자값으로만 구성된 정규형
- 즉, 제1정규화는 테이블의 컬럼이 원자값을 갖도록 테이블을 분해하는 것

![img](https://blog.kakaocdn.net/dn/cWnN4H/btrkvINLOvN/WCeNK8l2Kdixwf9SKa5o80/img.png)

출처: https://hongcoding.tistory.com/147



###### 제 2정규형

- 릴레이션이 제1정규형이면서, 기본키가 아닌 모든 속성이 키본키에 완전 함수 종속이 되는 경우
- 제2정규화란 부분 함수 종속을 제거하고, 모든 속성이 기본키에 완전 함수 종속 되도록 릴레이션을 분해하는 것
  - 완전 함수 종속
    - 어떤 속성이 기본키에 대해 완전히 종속일 때
    - 즉, 기본키로 다른 속성의 값을 알 수 있는 경우
  - 부분 함수 종속
    - 어떤 속성이 기본키가 아닌 다른 속성에 종속되는 경우
    - 기본키가 여러 속성으로 구성되어 있을 경우, 어떤 속성이 기본키를 구성하는 속성 중 일부만 종속되는 경우
    - 즉, 기본키가 아닌 다른 속성 혹은 기본키의 부분 속성만으로 다른 속성의 값을 알 수 있는 경우
- 분해하면 기본키와 해당 기본키에 종속되는 속성으로만 이루어짐

![img](https://blog.kakaocdn.net/dn/kAt80/btrkuJl1lkz/bF2qmwfoOsXMFYFpt9i0H0/img.png)

출처: https://hongcoding.tistory.com/147



###### 제 3정규형

- 릴레이션이 제2정규형이면서, 기본키가 아닌 모든 속성이 기본키에 이행적 함수 종속이 되지 않는 경우
  - 이행적 함수 종속
    - A→B, B→C인 경우, A→C가 성립되는 경우
    - 즉, A를 알면 B를 알고, B를 통해 C를 알 수 있는 경우
  - B를 수정했을 때, C도 수정되어야하는 번거로움을 해결하기 위해 제3정규화 진행

![img](https://blog.kakaocdn.net/dn/bHpEsK/btrkz43gDik/WwjuPIBtTdnsAsNLfeG86K/img.png)

출처: https://hongcoding.tistory.com/147



###### BCNF

- 제3정규형 릴레이션의 함수 종속 관계에서 모든 결정자가 후보키인 경우
- 즉, BCNF 정규화는 결정자이지만 후보키가 아닌 속성을 없애기 위해 분해하는 것

![img](https://blog.kakaocdn.net/dn/bBN6xu/btqT6IlqRF4/MvBoxYMxtgS1JT7t1AymnK/img.png)

![img](https://blog.kakaocdn.net/dn/3cbHr/btq3mNylPan/c6b2lBuH4OkdDNmrzGHWUk/img.png)

출처: https://mangkyu.tistory.com/110



###### 제 4정규형

- 릴레이션이 BCNF를 만족하면서, 함수 종속이 아닌 다치종속을 제거하는 경우

  - 다치 종속

    - 같은 테이블 내의 독립적인 두 개 이상의 컬럼이 또 다른 컬럼에 종속되는 경우

    - A → B일 때, 하나의 A값에 **여러 개의 B값(속성)**이 존재하면 다치 종속성을 가짐

    - 예를 들어, 학생 한명의 과목과 취미를 나타내는 테이블이 있는 경우

      - 과목과 취미는 학생 이름에 의해 결정
      - but, 하나의 학생 값에 과목과 취미로 복수의 값이 존재

      ![img](https://velog.velcdn.com/images/wisdom-one/post/430da4e4-51fb-4e0e-b31a-4602c094eb74/image.png)


- 따라서, 제4정규화는 다치종속을 제거해야함

  ![img](https://velog.velcdn.com/images/wisdom-one/post/0215ea08-f2d5-4ecc-ab87-94a27475b384/image.png)

출처 : https://velog.io/@wisdom-one/%EC%A0%95%EA%B7%9C%ED%99%94Normalization



###### 제 5정규형

- 릴레이션이 제4정규형을 만족하면서 후보키를 통하지 않는 조인 종속을 제거하는 경우

  - 조인 종속
    - 하나의 릴레이션을 여러 개의 릴레이션으로 분해했다가 다시 결합했을 때, 데이터 손실이 없는 경우 혹은 불필요한 데이터가 생기는 경우

  - 더 이상 릴레이션을 분해할 수 없게됨

- 4정규형 테이블에 대해 조인 연산을 수행한 경우

  ![img](https://velog.velcdn.com/images/wisdom-one/post/fee15ae1-3e08-4fa4-905a-d93707e972fe/image.png)

- 조인했을 때, 손실되는 데이터가 없었고, 불필요한 데이터 중복값이 생김

  - 즉, 5정규형을 만족하지 못함

- 5정규화를 통해 아래와 같이 분리

  ![img](https://velog.velcdn.com/images/wisdom-one/post/8a7c4fd8-b140-4144-b2c2-72cd2cf85955/image.png)

출처 : https://velog.io/@wisdom-one/%EC%A0%95%EA%B7%9C%ED%99%94Normalization



## DB 관련 질문

 

#### 1. 정규화 vs 정규화

- 정규화는 관계형 데이터베이스에서 이상현상을 제거하고 중복을 최소화하기 위해 데이터를 구조화하는 작업입니다. 무결성을 향상시킬 수 있고 DB 저장 용량을 효율적으로 관리할 수 있습니다. 

  하지만 정규화가 지나치면 테이블 간의 JOIN 연산이 많아져서 질의에 대한 응답 시간이 느려질 수 있습니다. (느려질 수도 있고 빨라질 수도 있음)

  이러한 문제점을 해결하기 위한 과정을 반정규화라고 합니다

  반정규화를 통해 DB의 성능을 향상시킬 수 있습니다.



#### 2. key

- 기본키와 유일키의 차이점

  유일키는 해당 속성의 값 혹은 속성들의 집합으로 테이블 내의 튜플을 구분할 수 있는 키를 의미합니다.

  이러한 유일키 중에서 하나 선택한 것이 기본키이며, 기본키는 null값을 가질 수 없다는 차이점이 있습니다. 또한, 기본키는 유일키 중에서 최소성을 만족해야합니다.

  즉, 튜플을 구분할 수 있는 가장 적은 개수의 속성이 기본키가 됩니다.



#### 3. 이상 현상이란?

- 이상 현상은 테이블을 설계할 때 잘못 설계하여 데이터를 삽입,삭제,수정할 때 생기는 논리적 오류를 말합니다.

  삽입 이상은 자료를 삽입할 때 의도하지 않은 데이터가 삽입되는 경우를 의미합니다. 

  삭제 이상의 경우, 특정 데이터를 삭제할 때, 의도하지 않은 데이터가 같이 삭제되어버리는 경우입니다.

  갱신이상은 중복된 데이터 중 일부가 수정될 때, 데이터 모순이 발생하는 현상을 의미합니다.
  참조 관계에 이상이 생길 수도 있고, 같은 값을 가져야하는 튜플 간 다른 데이터를 갖게되는 경우도 있습니다.

  이러한 이상현상을 최소화하기 위해 정규화를 진행합니다.
